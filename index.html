document.addEventListener("DOMContentLoaded", () => {
    liff.init({ liffId: "2003877495-kapxYKzm" }).then(() => {
        document.getElementById("go").addEventListener("click", () => {
            if (liff.isInClient()) {
                const t = new Date();
                let e = 3600 * (Number(document.querySelector("input[name='st_hour']").value) - t.getHours()) + 60 * (Number(document.querySelector("input[name='st_min']").value) - t.getMinutes()) + (Number(document.querySelector("input[name='st_sec']").value) - t.getSeconds() - 2);

                document.querySelector("#go").remove();

                setTimeout(() => {
                    liff.sendMessages([{ type: "text", text: document.getElementById("sendMessagesText").value }])
                        .then(function () {
                            setTimeout(() => {
                                liff.sendMessages([{ type: "text", text: document.getElementById("sendMessagesTextText").value }])
                            }, 1000);
                            document.getElementById("log").value += "Message sent\n";
                        })
                        .catch(function (e) {
                            document.getElementById("log").value += "sendMessagesText()=" + e + "\n";
                        });
                    liff.sendMessages([{ type: "text", text: document.getElementById("sendMessagesTextText").value }]);
                }, 1000 * e);
            } else {
                document.getElementById("log").value += "LIFF environment not available\n";
            }
        });
    }).catch(e => {
        document.getElementById("log").value = "Initialization error\n" + e;
    });
});
